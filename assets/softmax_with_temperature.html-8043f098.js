import{_ as t,o as n,c as l,a,b as s}from"./app-aa9cafec.js";const e="/MLblogs/imgs/2023-09-17-18-28-31-image.png",m="/MLblogs/imgs/2023-09-17-19-34-42-image.png",i="/MLblogs/imgs/2023-09-17-19-52-44-image.png",c={},r=a("h2",{id:"问题提出",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#问题提出","aria-hidden":"true"},"#"),s(" 问题提出")],-1),o=a("p",null,"高温蒸馏其实是用在模型蒸馏方向上，为的是让学生模型去尽可能的拟合教师模型的输出的分布，使用KL散度来衡量两种分布的损失。",-1),h=a("p",null,"模型在训练收敛后，往往通过softmax的输出不会是完全符合one-hot向量那种极端分布的，而是在各个类别上均有概率，推断时通过argmax取得概率最大的类别。教师模型中在这些负类别（非正确类别）上输出的概率分布包含了一定的隐藏信息。比如MNIST手写数字识别，标签为7的样本在输出时，类别7的概率虽然最大，但和类别1的概率更加接近，这就说明1和7很像，这是模型已经学到的隐藏的知识。",-1),p=a("h2",{id:"解决",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#解决","aria-hidden":"true"},"#"),s(" 解决")],-1),g=a("p",null,[s("为了缓解softmax模糊隐藏信息，为softmax公式里添加一个温度系数"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"T")]),a("annotation",{encoding:"application/x-tex"},"T")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T")])])]),s("：")],-1),d=a("div",{align:"center"},[a("img",{src:e,title:"",alt:"","data-align":"center"})],-1),u=a("p",null,"温度系数值对最终分布的影响如下：",-1),_=a("div",{align:"center"},[a("img",{src:m,title:"",alt:"","data-align":"center"})],-1),x=a("p",null,[s("更直观的看一下"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"T")]),a("annotation",{encoding:"application/x-tex"},"T")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T")])])]),s("对分类任务的各个类别的预测值的影响程度：")],-1),w=a("div",{align:"center"},[a("img",{src:i,title:"",alt:"","data-align":"center"})],-1),M=a("p",null,[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"T"),a("mo",null,"="),a("mn",null,"1")]),a("annotation",{encoding:"application/x-tex"},"T=1")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6444em"}}),a("span",{class:"mord"},"1")])])]),s("代表传统softmax，"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"T"),a("mo",null,"<"),a("mn",null,"1")]),a("annotation",{encoding:"application/x-tex"},"T<1")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.7224em","vertical-align":"-0.0391em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"<"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6444em"}}),a("span",{class:"mord"},"1")])])]),s("分布逐渐极端化，最终趋近于argmax，"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"T"),a("mo",null,">"),a("mn",null,"1")]),a("annotation",{encoding:"application/x-tex"},"T>1")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.7224em","vertical-align":"-0.0391em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},">"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6444em"}}),a("span",{class:"mord"},"1")])])]),s("分布逐渐趋于均匀。当"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"T")]),a("annotation",{encoding:"application/x-tex"},"T")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T")])])]),s("趋于无穷大时，分布将趋于均匀分布，此时信息熵趋于最大。")],-1),y=a("p",null,"为什么叫高温蒸馏呢？温度越高，粒子运动越不规则，熵越大。这里是温度系数越大，则最终输出分布的熵越大，和温度很像。",-1),k=a("p",null,"参考：",-1),T=a("p",null,"https://zhuanlan.zhihu.com/p/504323465",-1),b=[r,o,h,p,g,d,u,_,x,w,M,y,k,T];function f(L,v){return n(),l("div",null,b)}const N=t(c,[["render",f],["__file","softmax_with_temperature.html.vue"]]);export{N as default};
